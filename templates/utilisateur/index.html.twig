{% extends 'base1.html.twig' %}

{% block title %}Utilisateur index{% endblock %}

{% block body %}
<div class="container mt-5">
    <h1 class="mb4">Liste des utilisateurs</h1>
    <div class="row">
        <div class="col-md-6 col-lg-4">
            <form method="get" class="mb-3" style="max-width: 400px;">
                <div class="input-group">
                    <select name="field" class="form-select" style="max-width: 120px;">
                        <option value="nomutilisateur" {% if field == 'nomutilisateur' %}selected{% endif %}>Nom</option>
                        <option value="prenomutilisateur" {% if field == 'prenomutilisateur' %}selected{% endif %}>Prénom</option>
                        <option value="emailutilisateur" {% if field == 'emailutilisateur' %}selected{% endif %}>Email</option>
                        <option value="ageutilisateur" {% if field == 'ageutilisateur' %}selected{% endif %}>Age</option>
                    </select>
                    <input 
                        type="text" 
                        name="search" 
                        class="form-control" 
                        placeholder="Rechercher..." 
                        value="{{ search }}"
                    >
                    <button class="btn btn-primary" type="submit">Rechercher</button>
                </div>
            </form>
        </div>
    </div>


    <table class="table table-striped">
        <thead>
            <tr>
                <th>
                    <a href="{{ path('app_utilisateur_index', { search: search, field: field, sort: 'nomutilisateur', direction: sort == 'nomutilisateur' and direction == 'asc' ? 'desc' : 'asc' }) }}">
                        Nom d'utilisateur
                        {% if sort == 'nomutilisateur' %}
                            <i class="fas fa-sort-{{ direction == 'asc' ? 'up' : 'down' }}"></i>
                        {% endif %}
                    </a>
                </th>
                <th>
                    <a href="{{ path('app_utilisateur_index', { search: search, field: field, sort: 'prenomutilisateur', direction: sort == 'prenomutilisateur' and direction == 'asc' ? 'desc' : 'asc' }) }}">
                        Prénom d'utilisateur
                        {% if sort == 'prenomutilisateur' %}
                            <i class="fas fa-sort-{{ direction == 'asc' ? 'up' : 'down' }}"></i>
                        {% endif %}
                    </a>
                </th>
                <th>
                    <a href="{{ path('app_utilisateur_index', { search: search, field: field, sort: 'ageutilisateur', direction: sort == 'ageutilisateur' and direction == 'asc' ? 'desc' : 'asc' }) }}">
                        Âge d'utilisateur
                        {% if sort == 'ageutilisateur' %}
                            <i class="fas fa-sort-{{ direction == 'asc' ? 'up' : 'down' }}"></i>
                        {% endif %}
                    </a>
                </th>
                <th>
                    <a href="{{ path('app_utilisateur_index', { search: search, field: field, sort: 'emailutilisateur', direction: sort == 'emailutilisateur' and direction == 'asc' ? 'desc' : 'asc' }) }}">
                        Email d'utilisateur
                        {% if sort == 'emailutilisateur' %}
                            <i class="fas fa-sort-{{ direction == 'asc' ? 'up' : 'down' }}"></i>
                        {% endif %}
                    </a>
                </th>
                <th>Role</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
        {% for utilisateur in utilisateurs %}
            <tr>
                <td>{{ utilisateur.nomutilisateur }}</td>
                <td>{{ utilisateur.prenomutilisateur }}</td>
                <td>{{ utilisateur.ageutilisateur }}</td>
                <td>{{ utilisateur.emailutilisateur }}</td>
                <td>{{ utilisateur.role.getlabel() }}</td>
                <td class="text-center">
                    <a 
                        href="{{ path('app_utilisateur_edit', {'idutilisateur': utilisateur.idutilisateur}) }}" 
                        class="btn btn-primary btn-sm d-block mx-auto text-center" 
                        style="width: 100px;"
                    >Modifier</a>

                    <div class="mt-2">
                        {{ include('utilisateur/_delete_form.html.twig', { utilisateur: utilisateur }) }}
                    </div>
                </td>

            </tr>
        {% else %}  
            <tr>
                <td colspan="6" class="text-center">Aucun utilisateur trouvé.</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    <a href="{{ path('app_utilisateur_new') }}">Create new</a>
</div>
{% endblock %}
